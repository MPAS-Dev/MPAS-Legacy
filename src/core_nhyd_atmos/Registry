%
% namelist  type  namelist_record  name  default_value
%
namelist character nhyd_model config_time_integration     SRK3
namelist real      nhyd_model config_dt                   600.0
namelist character nhyd_model config_calendar_type        gregorian
namelist character nhyd_model config_start_time           0000-01-01_00:00:00
namelist character nhyd_model config_stop_time            none
namelist character nhyd_model config_run_duration         none
namelist character nhyd_model config_sfc_update_interval  none
namelist character nhyd_model config_horiz_mixing         2d_smagorinsky
namelist real      nhyd_model config_h_mom_eddy_visc2     0.0
namelist real      nhyd_model config_h_mom_eddy_visc4     0.0
namelist real      nhyd_model config_v_mom_eddy_visc2     0.0
namelist real      nhyd_model config_h_theta_eddy_visc2   0.0
namelist real      nhyd_model config_h_theta_eddy_visc4   0.0
namelist real      nhyd_model config_v_theta_eddy_visc2   0.0
namelist integer   nhyd_model config_number_of_sub_steps  4
namelist integer   nhyd_model config_w_adv_order          3
namelist integer   nhyd_model config_theta_adv_order      3
namelist integer   nhyd_model config_scalar_adv_order     3
namelist integer   nhyd_model config_u_vadv_order         3
namelist integer   nhyd_model config_w_vadv_order         3
namelist integer   nhyd_model config_theta_vadv_order     3
namelist integer   nhyd_model config_scalar_vadv_order    3
namelist real      nhyd_model config_coef_3rd_order       0.25
namelist logical   nhyd_model config_scalar_advection     true
namelist logical   nhyd_model config_positive_definite    false
namelist logical   nhyd_model config_monotonic            true
namelist logical   nhyd_model config_mix_full             true
namelist real      nhyd_model config_len_disp             120000.0
namelist real      nhyd_model config_epssm                0.1
namelist real      nhyd_model config_smdiv                0.1
namelist logical   nhyd_model config_newpx                false
namelist real      nhyd_model config_apvm_upwinding       0.5
namelist logical   nhyd_model config_h_ScaleWithMesh      false
namelist integer   nhyd_model config_num_halos            2
namelist real      damping    config_zd                   22000.0
namelist real      damping    config_xnutr                0.0
namelist character io         config_input_name           init.nc
namelist character io         config_sfc_update_name      sfc_update.nc
namelist character io         config_output_name          output.nc
namelist character io         config_restart_name         restart.nc
namelist character io         config_output_interval      06:00:00
namelist integer   io         config_frames_per_outfile   0
namelist integer   io         config_pio_num_iotasks      0 
namelist integer   io         config_pio_stride           1
namelist character decomposition config_block_decomp_file_prefix  graph.info.part.
namelist integer   decomposition config_number_of_blocks          0
namelist logical   decomposition config_explicit_proc_decomp      .false.
namelist character decomposition config_proc_decomp_file_prefix   graph.info.part.
namelist logical   restart    config_do_restart           false
namelist logical   restart    config_do_DAcycling         false
namelist character restart    config_restart_interval     none

%
% dim  type  name_in_file  name_in_code
%
dim nCells nCells
dim nEdges nEdges
dim maxEdges maxEdges
dim maxEdges2 maxEdges2
dim nVertices nVertices
dim TWO 2
dim THREE 3
dim vertexDegree vertexDegree
dim FIFTEEN 15
dim TWENTYONE 21
dim R3 3
dim nVertLevels nVertLevels
dim nVertLevelsP1 nVertLevels+1

%
% var  type  name_in_file  ( dims )  iro-  name_in_code super-array array_class
%
var persistent text    xtime ( Time ) 2 iro xtime state - -

%  horizontal grid structure

var persistent real    latCell ( nCells ) 0 iro latCell mesh - -
var persistent real    lonCell ( nCells ) 0 iro lonCell mesh - -
var persistent real    xCell ( nCells ) 0 iro xCell mesh - -
var persistent real    yCell ( nCells ) 0 iro yCell mesh - -
var persistent real    zCell ( nCells ) 0 iro zCell mesh - -
var persistent integer indexToCellID ( nCells ) 0 iro indexToCellID mesh - -

var persistent real    latEdge ( nEdges ) 0 iro latEdge mesh - -
var persistent real    lonEdge ( nEdges ) 0 iro lonEdge mesh - -
var persistent real    xEdge ( nEdges ) 0 iro xEdge mesh - -
var persistent real    yEdge ( nEdges ) 0 iro yEdge mesh - -
var persistent real    zEdge ( nEdges ) 0 iro zEdge mesh - -
var persistent integer indexToEdgeID ( nEdges ) 0 iro indexToEdgeID mesh - -

var persistent real    latVertex ( nVertices ) 0 iro latVertex mesh - -
var persistent real    lonVertex ( nVertices ) 0 iro lonVertex mesh - -
var persistent real    xVertex ( nVertices ) 0 iro xVertex mesh - -
var persistent real    yVertex ( nVertices ) 0 iro yVertex mesh - -
var persistent real    zVertex ( nVertices ) 0 iro zVertex mesh - -
var persistent integer indexToVertexID ( nVertices ) 0 iro indexToVertexID mesh - -

var persistent integer cellsOnEdge ( TWO nEdges ) 0 iro cellsOnEdge mesh - -
var persistent integer nEdgesOnCell ( nCells ) 0 iro nEdgesOnCell mesh - -
var persistent integer nEdgesOnEdge ( nEdges ) 0 iro nEdgesOnEdge mesh - -
var persistent integer edgesOnCell ( maxEdges nCells ) 0 iro edgesOnCell mesh - -
var persistent integer edgesOnEdge ( maxEdges2 nEdges ) 0 iro edgesOnEdge mesh - -

var persistent real    weightsOnEdge ( maxEdges2 nEdges ) 0 iro weightsOnEdge mesh - -
var persistent real    dvEdge ( nEdges ) 0 iro dvEdge mesh - -
var persistent real    dcEdge ( nEdges ) 0 iro dcEdge mesh - -
var persistent real    angleEdge ( nEdges ) 0 iro angleEdge mesh - -
var persistent real    areaCell ( nCells ) 0 iro areaCell mesh - -
var persistent real    areaTriangle ( nVertices ) 0 iro areaTriangle mesh - -

var persistent real    edgeNormalVectors ( R3 nEdges ) 0 iro edgeNormalVectors mesh - -
var persistent real    localVerticalUnitVectors ( R3 nCells ) 0 iro localVerticalUnitVectors mesh - -
var persistent real    cellTangentPlane ( R3 TWO nCells ) 0 iro cellTangentPlane mesh - -

var persistent integer cellsOnCell ( maxEdges nCells ) 0 iro cellsOnCell mesh - -
var persistent integer verticesOnCell ( maxEdges nCells ) 0 iro verticesOnCell mesh - -
var persistent integer verticesOnEdge ( TWO nEdges ) 0 iro verticesOnEdge mesh - -
var persistent integer edgesOnVertex ( vertexDegree nVertices ) 0 iro edgesOnVertex mesh - -
var persistent integer cellsOnVertex ( vertexDegree nVertices ) 0 iro cellsOnVertex mesh - -
var persistent real    kiteAreasOnVertex ( vertexDegree nVertices ) 0 iro kiteAreasOnVertex mesh - -
var persistent real    fEdge ( nEdges ) 0 iro fEdge mesh - -
var persistent real    fVertex ( nVertices ) 0 iro fVertex mesh - -

var persistent real    meshDensity ( nCells ) 0 iro meshDensity mesh - -
var persistent real    meshScalingDel2 ( nEdges ) 0 ro meshScalingDel2 mesh - -
var persistent real    meshScalingDel4 ( nEdges ) 0 ro meshScalingDel4 mesh - -

% some solver scalar coefficients

% coefficients for vertical extrapolation to the surface
var persistent real    cf1 ( ) 0 iro cf1 mesh - -
var persistent real    cf2 ( ) 0 iro cf2 mesh - -
var persistent real    cf3 ( ) 0 iro cf3 mesh - -

var persistent real    cpr ( THREE nEdges ) 0 ro cpr mesh - -
var persistent real    cpl ( THREE nEdges ) 0 ro cpl mesh - -

% description of the vertical grid structure

var persistent real    hx ( nVertLevelsP1 nCells ) 0 iro hx mesh - -
var persistent real    zgrid ( nVertLevelsP1 nCells ) 0 iro zgrid mesh - -
var persistent real    rdzw ( nVertLevels ) 0 iro rdzw mesh - -
var persistent real    dzu ( nVertLevels ) 0 iro dzu mesh - -
var persistent real    rdzu ( nVertLevels ) 0 iro rdzu mesh - -
var persistent real    fzm ( nVertLevels ) 0 iro fzm mesh - -
var persistent real    fzp ( nVertLevels ) 0 iro fzp mesh - -
var persistent real    zx ( nVertLevelsP1 nEdges ) 0 iro zx mesh - -
var persistent real    zz ( nVertLevelsP1 nCells ) 0 iro zz mesh - -
var persistent real    zb ( nVertLevelsP1 TWO nEdges ) 0 iro zb mesh - -
var persistent real    zb3 ( nVertLevelsP1 TWO nEdges ) 0 iro zb3 mesh - -
var persistent real    pzm ( nVertLevels nCells ) 0 r pzm mesh - -
var persistent real    pzp ( nVertLevels nCells ) 0 r pzp mesh - -

% coefficients for the vertical tridiagonal solve
% Note:  these could be local but...

var persistent real    cofrz ( nVertLevels Time ) 1 - cofrz diag - -
var persistent real    cofwr ( nVertLevels nCells Time ) 1 - cofwr diag - -
var persistent real    cofwz ( nVertLevels nCells Time ) 1 - cofwz diag - -
var persistent real    coftz ( nVertLevelsP1 nCells Time ) 1 - coftz diag - -
var persistent real    cofwt ( nVertLevels nCells Time ) 1 - cofwt diag - -
var persistent real    a_tri ( nVertLevels nCells Time ) 1 - a_tri diag - -
var persistent real    alpha_tri ( nVertLevels nCells Time ) 1 - alpha_tri diag - -
var persistent real    gamma_tri ( nVertLevels nCells Time ) 1 - gamma_tri diag - -

%  W-Rayleigh-damping coefficient

var persistent real    dss ( nVertLevels nCells ) 0 iro dss mesh - -

% Prognostic variables: read from input, saved in restart, and written to output
var persistent real    u ( nVertLevels nEdges Time ) 2 iro u state - -
var persistent real    w ( nVertLevelsP1 nCells Time ) 2 iro w state - -
var persistent real    rho_zz ( nVertLevels nCells Time ) 2 r rho_zz state - -
var persistent real    theta_m ( nVertLevels nCells Time ) 2 r theta_m state - -
var persistent real    qv ( nVertLevels nCells Time ) 2 iro qv state scalars moist
var persistent real    qc ( nVertLevels nCells Time ) 2 iro qc state scalars moist
var persistent real    qr ( nVertLevels nCells Time ) 2 iro qr state scalars moist
var persistent real    qi ( nVertLevels nCells Time ) 2 iro qi state scalars moist
var persistent real    qs ( nVertLevels nCells Time ) 2 iro qs state scalars moist
var persistent real    qg ( nVertLevels nCells Time ) 2 iro qg state scalars moist
var persistent real    qnr ( nVertLevels nCells Time ) 2 iro qnr state scalars number
var persistent real    qni ( nVertLevels nCells Time ) 2 iro qni state scalars number

% Tendency variables
var persistent real    tend_u ( nVertLevels nEdges Time ) 1 o u tend - -
var persistent real    tend_w ( nVertLevelsP1 nCells Time ) 1 o w tend - -
var persistent real    tend_rho ( nVertLevels nCells Time ) 1 o rho_zz tend - -
var persistent real    tend_theta ( nVertLevels nCells Time ) 1 o theta_m tend - -
var persistent real    tend_qv ( nVertLevels nCells Time ) 1 o qv tend scalars moist
var persistent real    tend_qc ( nVertLevels nCells Time ) 1 o qc tend scalars moist
var persistent real    tend_qr ( nVertLevels nCells Time ) 1 o qr tend scalars moist
var persistent real    tend_qi ( nVertLevels nCells Time ) 1 o qi tend scalars moist
var persistent real    tend_qs ( nVertLevels nCells Time ) 1 o qs tend scalars moist
var persistent real    tend_qg ( nVertLevels nCells Time ) 1 o qg tend scalars moist
var persistent real    tend_qnr ( nVertLevels nCells Time ) 1 o qnr tend scalars number
var persistent real    tend_qni ( nVertLevels nCells Time ) 1 o qni tend scalars number
var persistent real    rt_diabatic_tend ( nVertLevels nCells Time ) 1 r rt_diabatic_tend tend - -

var persistent real    euler_tend_u ( nVertLevels nEdges Time ) 1 - u_euler tend - -
var persistent real    euler_tend_w ( nVertLevelsP1 nCells Time ) 1 - w_euler tend - -
var persistent real    euler_tend_theta ( nVertLevels nCells Time ) 1 - theta_euler tend - -

% state variables diagnosed from prognostic state
var persistent real    pressure_p ( nVertLevels nCells Time ) 1 ro pressure_p diag - -

var persistent real    u_init ( nVertLevels ) 0 iro u_init mesh - -
var persistent real    t_init ( nVertLevels nCells ) 0 iro t_init mesh - -
var persistent real    qv_init ( nVertLevels ) 0 iro qv_init mesh - -

% Diagnostic fields: only written to output
% NOTE: added the "r" option to rho,theta,uReconstructZonal,and uReconstructMeridional for use of the
% non-hydrostatic dynamical core in a data assimilation framework. NOTE that the "r" option is not
% needed for those 4 variables to get bit for bit restart capabilities, otherwise. 
var persistent real    rho ( nVertLevels nCells Time ) 1 iro rho diag - -
var persistent real    theta ( nVertLevels nCells Time ) 1 iro theta diag - -
var persistent real    rh ( nVertLevels nCells Time ) 1 iro rh diag - -
var persistent real    v ( nVertLevels nEdges Time ) 1 o v diag - -
var persistent real    divergence ( nVertLevels nCells Time ) 1 o divergence diag - -
var persistent real    vorticity ( nVertLevels nVertices Time ) 1 o vorticity diag - -
var persistent real    pv_edge ( nVertLevels nEdges Time ) 1 o pv_edge diag - -
var persistent real    rho_edge ( nVertLevels nEdges Time ) 1 o rho_edge diag - -
var persistent real    ke ( nVertLevels nCells Time ) 1 o ke diag - -
var persistent real    pv_vertex ( nVertLevels nVertices Time ) 1 o pv_vertex diag - -
var persistent real    pv_cell ( nVertLevels nCells Time ) 1 o pv_cell diag - -
var persistent real    uReconstructX ( nVertLevels nCells Time ) 1 o uReconstructX diag - -
var persistent real    uReconstructY ( nVertLevels nCells Time ) 1 o uReconstructY diag - -
var persistent real    uReconstructZ ( nVertLevels nCells Time ) 1 o uReconstructZ diag - -
var persistent real    uReconstructZonal ( nVertLevels nCells Time ) 1 ro uReconstructZonal diag - -
var persistent real    uReconstructMeridional ( nVertLevels nCells Time ) 1 ro uReconstructMeridional diag - -

% Other diagnostic variables: neither read nor written to any files
var persistent real    rv ( nVertLevels nEdges Time ) 1 r rv diag - -
var persistent real    circulation ( nVertLevels nVertices Time ) 1 r circulation diag - -
var persistent real    gradPVt ( nVertLevels nEdges Time ) 1 - gradPVt diag - -
var persistent real    gradPVn ( nVertLevels nEdges Time ) 1 - gradPVn diag - -
var persistent real    h_divergence ( nVertLevels nCells Time ) 1 o h_divergence diag - -

var persistent real    exner ( nVertLevels nCells Time ) 1 ro exner diag - -
var persistent real    exner_base ( nVertLevels nCells Time ) 1 iro exner_base diag - -
var persistent real    rtheta_base ( nVertLevels nCells Time ) 1 r rtheta_base diag - -
var persistent real    pressure_base ( nVertLevels nCells Time ) 1 iro pressure_base diag - -
var persistent real    rho_base ( nVertLevels nCells Time ) 1 iro rho_base diag - -
var persistent real    theta_base ( nVertLevels nCells Time ) 1 iro theta_base diag - -


var persistent real    ruAvg ( nVertLevels nEdges Time ) 1 - ruAvg diag - -
var persistent real    wwAvg ( nVertLevelsP1 nCells Time ) 1 - wwAvg diag - -
var persistent real    cqu  ( nVertLevels nEdges Time ) 1 - cqu diag - -
var persistent real    cqw  ( nVertLevels nCells Time ) 1 - cqw diag - -

%  coupled variables needed by the solver, but not output...

var persistent real    ru ( nVertLevels nEdges Time ) 1 r ru diag - -
var persistent real    ru_p ( nVertLevels nEdges Time ) 1 r ru_p diag - -
var persistent real    ru_save ( nVertLevels nEdges Time ) 1 - ru_save diag - -


var persistent real    rw ( nVertLevelsP1 nCells Time ) 1 r rw diag - -
var persistent real    rw_p ( nVertLevelsP1 nCells Time ) 1 r rw_p diag - -
var persistent real    rw_save ( nVertLevelsP1 nCells Time ) 1 - rw_save diag - -

var persistent real    rtheta_p ( nVertLevels nCells Time ) 1 r rtheta_p diag - -
var persistent real    rtheta_pp ( nVertLevels nCells Time ) 1 - rtheta_pp diag - -
var persistent real    rtheta_p_save ( nVertLevels nCells Time ) 1 - rtheta_p_save diag - -
var persistent real    rtheta_pp_old ( nVertLevels nCells Time ) 1 - rtheta_pp_old diag - -

var persistent real    rho_p ( nVertLevels nCells Time ) 1 r rho_p diag - -
var persistent real    rho_pp ( nVertLevels nCells Time ) 1 - rho_pp diag - -
var persistent real    rho_p_save ( nVertLevels nCells Time ) 1 - rho_p_save diag - -

% Space needed for advection
var persistent real    deriv_two ( FIFTEEN TWO nEdges ) 0 ir deriv_two mesh - -
var persistent integer advCells ( TWENTYONE nCells ) 0 ir advCells mesh - -
var persistent real    adv_coefs ( FIFTEEN nEdges ) 0 - adv_coefs mesh - -
var persistent real    adv_coefs_3rd ( FIFTEEN nEdges ) 0 - adv_coefs_3rd mesh - -
var persistent integer advCellsForEdge ( FIFTEEN nEdges ) 0 - advCellsForEdge mesh - -
var persistent integer nAdvCellsForEdge ( nEdges ) 0 - nAdvCellsForEdge mesh - -


% Space needed for deformation calculation weights
var persistent real    defc_a ( maxEdges nCells ) 0 iro defc_a mesh - -
var persistent real    defc_b ( maxEdges nCells ) 0 iro defc_b mesh - -
var persistent real    kdiff ( nVertLevels nCells Time ) 1 - kdiff diag - -

% Arrays required for reconstruction of velocity field
var persistent real    coeffs_reconstruct ( R3 maxEdges nCells ) 0 iro coeffs_reconstruct mesh - -

% ADDED DECLARATIONS MADE BY LDF:
var persistent real    surface_pressure    ( nCells Time    ) 1 iro surface_pressure    diag - -
var persistent real    surface_temperature ( nCells Time    ) 1   o surface_temperature diag - -

%==================================================================================================
% DECLARATIONS OF ALL PHYSICS VARIABLES (will need to be moved to a Physics Registry shared by the
% hydrostatic and non-hydrostatic dynamical cores):
%==================================================================================================

%... NAMELIST VARIABLES ADDED FOR INITIALIZATION OF SURFACE CHARACTERISTICS:
namelist character physics  input_landuse_data          USGS
namelist character physics  input_soil_data             STAS
namelist integer   physics  input_soil_temperature_lag   140
namelist integer   physics  num_soil_layers                4
namelist integer   physics  months                        12

%... NAMELIST VARIABLE NEEDED FOR THE TIME MANAGER:
dim nMonths namelist:months

%... DIMENSION NEEDED FOR NUMBER OF SOIL LAYERS:
dim nSoilLevels namelist:num_soil_layers

%... DIMENSION NEEDED FOR UPDATING THE DEEP SOIL TEMPERATURE:
dim nLags namelist:input_soil_temperature_lag 

%... DIMENSION NEEDED FOR OZONE AND AEROSOLS CONCENTRATIONS IN THE CAM LONGWAVE AND SHORTWAVE
%... RADIATION PARAMETERIZATIONS.
% noznlev : number of CAM radiation input ozone levels.
% naerlev : number of CAM radiation input aerosol levels.

namelist integer   physics  noznlev                       59
namelist integer   physics  naerlev                       29
namelist integer   physics  camdim1                       4
dim nOznLevels     namelist:noznlev
dim nAerLevels     namelist:naerlev
dim cam_dim1       namelist:camdim1

%... DIMENSION NEEDED FOR LONGWAVE AND SHORTWAVE RADIATION FLUXES TO INCLUDE AN ADDITIONAL LAYER
%... BETWEEN THE TOP OF THE MODEL AND THE TOP OF THE ATMOSPHERE
dim nVertLevelsP2 nVertLevels+2

%... NAMELIST VARIABLES ADDED FOR PHYSICS CONFIGURATION:
namelist logical   physics  config_frac_seaice          false
namelist logical   physics  config_sfc_albedo           false
namelist logical   physics  config_sfc_snowalbedo       false
namelist logical   physics  config_sst_update           false
namelist logical   physics  config_sstdiurn_update      false
namelist logical   physics  config_deepsoiltemp_update  false

namelist integer   physics  config_n_physics            1
namelist integer   physics  config_n_microp             1
namelist integer   physics  config_n_conv               1
namelist integer   physics  config_n_pbl                1
namelist integer   physics  config_n_lsm                1
namelist integer   physics  config_n_eddy               1
namelist integer   physics  config_n_radt_lw            1
namelist integer   physics  config_n_radt_sw            1

namelist character physics  config_radtlw_interval       none
namelist character physics  config_radtsw_interval       none
namelist character physics  config_conv_interval         none
namelist character physics  config_pbl_interval          none
namelist character physics  config_camrad_abs_update     06:00:00
namelist character physics  config_greeness_update       24:00:00
namelist character physics  config_bucket_update         none

namelist character physics  config_microp_scheme          off
namelist character physics  config_conv_shallow_scheme    off
namelist character physics  config_conv_deep_scheme       off
namelist character physics  config_eddy_scheme            off 
namelist character physics  config_lsm_scheme             off
namelist character physics  config_pbl_scheme             off
namelist character physics  config_radt_cld_scheme        off
namelist character physics  config_radt_lw_scheme         off
namelist character physics  config_radt_sw_scheme         off
namelist character physics  config_sfclayer_scheme        off

namelist real      physics  config_bucket_radt            0.0_RKIND
namelist real      physics  config_bucket_rainc           0.0_RKIND
namelist real      physics  config_bucket_rainnc          0.0_RKIND

var persistent real    east       ( R3 nCells               ) 0  r   east          mesh         - -
var persistent real    north      ( R3 nCells               ) 0  r   north         mesh         - -

%--------------------------------------------------------------------------------------------------
%... ARRAYS AND VARIABLES FOR UPDATING THE DEEP SOIL TEMPERATURE:
%--------------------------------------------------------------------------------------------------

% nsteps_accum: number of accumulated time-step in a day.
% ndays_accum : number of accumulated days in a year.
% tlag        : daily mean surface temperature of prior days                                    [K]
% tday_accum  : accumulated daily surface temperature for current day                           [K]
% tyear_mean  : annual mean surface temperature                                                 [K]
% tyear_accum : accumulated yearly surface temperature for current year                         [K]

var persistent real    nsteps_accum ( nCells Time           ) 1  r  nsteps_accum   diag_physics - -
var persistent real    ndays_accum  ( nCells Time           ) 1  r  ndays_accum    diag_physics - -

var persistent real    tlag         ( nLags nCells Time     ) 1  r  tlag           diag_physics - -
var persistent real    tday_accum   ( nCells Time           ) 1  r  tday_accum     diag_physics - -           
var persistent real    tyear_mean   ( nCells Time           ) 1  r  tyear_mean     diag_physics - -
var persistent real    tyear_accum  ( nCells Time           ) 1  r  tyear_accum    diag_physics - -

%--------------------------------------------------------------------------------------------------
%... PARAMETERIZATION OF CLOUD MICROPHYSICS:
%--------------------------------------------------------------------------------------------------
% i_rainnc  : counter related to how often rainnc is being reset relative to its bucket value   (-)
% rainnc    : accumulated total time-step grid-scale precipitation                             (mm)
% rainncv   : time-step total grid-scale precipitation                                         (mm)
% snownc    : accumulated grid-scale precipitation of snow                                     (mm)
% snowncv   : time-step grid-scale precipitation of snow                                       (mm)
% graupelnc : accumulated grid-scale precipitation of graupel                                  (mm)
% graupelncv: time-step grid-scale precipitation of graupel                                    (mm)
% sr        : time-step ratio of frozen versus total grid-scale precipitation                   (-)

var persistent integer i_rainnc   ( nCells Time             ) 1  ro i_rainnc       diag_physics - -
var persistent real    sr         ( nCells Time             ) 1  ro sr             diag_physics - -
var persistent real    rainncv    ( nCells Time             ) 1  ro rainncv        diag_physics - -
var persistent real    snowncv    ( nCells Time             ) 1   o snowncv        diag_physics - -
var persistent real    graupelncv ( nCells Time             ) 1   o graupelncv     diag_physics - -

var persistent real    rainnc     ( nCells Time             ) 1  ro rainnc         diag_physics - -
var persistent real    snownc     ( nCells Time             ) 1  ro snownc         diag_physics - -
var persistent real    graupelnc  ( nCells Time             ) 1  ro graupelnc      diag_physics - -

var persistent real    qsat       ( nVertLevels nCells Time ) 1  o  qsat           diag_physics - -
var persistent real    relhum     ( nVertLevels nCells Time ) 1  o  relhum         diag_physics - -

%--------------------------------------------------------------------------------------------------
%... PARAMETERIZATION OF CONVECTION:
%--------------------------------------------------------------------------------------------------
% i_rainc   : counter related to how often rainc is begin reset relative to its bucket value    (-)
% cuprec    : convective precipitation rate                                                  (mm/s)
% rainc     : accumulated time-step convective precipitation                                   (mm)
% raincv    : time-step convective precipitation                                               (mm)
% rthcuten  : tendency of potential temperature due to cumulus convection                   (K s-1)
% rqvcuten  : tendency of water vapor mixing ratio due to cumulus convection            (kg/kg s-1)
% rqccuten  : tendency of cloud water mixing ratio due to cumulus convection            (kg/kg s-1)
% rqicuten  : tendency of cloud ice mixing ratio due to cumulus convection              (kg/kg s-1)

var persistent integer i_rainc  ( nCells Time              ) 1  ro i_rainc         diag_physics - -
var persistent real    cuprec   ( nCells Time              ) 1  ro cuprec          diag_physics - -
var persistent real    rainc    ( nCells Time              ) 1  ro rainc           diag_physics - -
var persistent real    raincv   ( nCells Time              ) 1  ro raincv          diag_physics - -

var persistent real   rthcuten  ( nVertLevels nCells Time  ) 1  ro rthcuten        tend_physics - -
var persistent real   rqvcuten  ( nVertLevels nCells Time  ) 1  ro rqvcuten        tend_physics - -
var persistent real   rqccuten  ( nVertLevels nCells Time  ) 1  ro rqccuten        tend_physics - -
var persistent real   rqicuten  ( nVertLevels nCells Time  ) 1  ro rqicuten        tend_physics - -

%... KAIN_FRITSCH:
% cubot     : lowest level of convection                                                        (-)
% cutop     : highest level of convection                                                       (-)
% nca       : relaxation time for KF parameterization of convection                             (s)
% wavg0     : average vertical velocity (KF scheme only)                                    (m s-1)
% rqrcuten  : tendency of rain mixing ratio due to cumulus convection                   (kg/kg s-1)
% rqscuten  : tendency of snow mixing ratio due to cumulus convection                   (kg/kg s-1)

var persistent real   nca       ( nCells Time              ) 1  ro nca             diag_physics - -
var persistent real   cubot     ( nCells Time              ) 1  ro cubot           diag_physics - -
var persistent real   cutop     ( nCells Time              ) 1  ro cutop           diag_physics - -
var persistent real   w0avg     ( nVertLevels nCells Time  ) 1  ro w0avg           diag_physics - -
var persistent real   rqrcuten  ( nVertLevels nCells Time  ) 1  ro rqrcuten        tend_physics - -
var persistent real   rqscuten  ( nVertLevels nCells Time  ) 1  ro rqscuten        tend_physics - -

%... TIEDTKE:
% rucuten   : tendency of zonal wind due to cumulus convection                              (m/s-1)
% rvcuten   : tendency of meridional wind due to cumulus convection                         (m/s-1)
% rqvdynten : tendency of water vapor due to horizontal and vertical advections         (kg/kg/s-1)

var persistent real   rqvdynten ( nVertLevels nCells Time  ) 1  ro rqvdynten       tend_physics - -
var persistent real   rucuten   ( nVertLevels nCells Time  ) 1  ro rucuten         tend_physics - -
var persistent real   rvcuten   ( nVertLevels nCells Time  ) 1  ro rvcuten         tend_physics - -

%--------------------------------------------------------------------------------------------------
%... PARAMETERIZATION OF PLANETARY BOUNDARY LAYER PROCESSES:
%--------------------------------------------------------------------------------------------------

% kpbl      : index of PBL top                                                                  (-)
% hpbl      : PBL height                                                                        (m)
% exch_h    : exchange coefficient                                                              (-)
% rublten   : tendency of zonal wind due to pbl processes                                   (m s-1)
% rvblten   : tendency of meridional wind due to pbl processes                              (m s-1)
% rthblten  : tendency of potential temperature due to pbl processes                        (K s-1)
% rqvblten  : tendency of water vapor mixing ratio due to pbl processes                 (kg/kg s-1)
% rqcblten  : tendency of cloud water mixing ratio due to pbl processes                 (kg/kg s-1)
% rqiblten  : tendency of cloud ice mixing ratio due to pbl processes                   (kg/kg s-1)

var persistent integer kpbl     ( nCells Time               ) 1  ro kpbl           diag_physics - - 
var persistent real    hpbl     ( nCells Time               ) 1  ro hpbl           diag_physics - - 
var persistent real    exch_h   ( nVertLevels nCells Time   ) 1   o exch_h         diag_physics - -

%    TENDENCIES:
var persistent real    rublten  ( nVertLevels nCells Time   ) 1  ro rublten        tend_physics - -
var persistent real    rvblten  ( nVertLevels nCells Time   ) 1  ro rvblten        tend_physics - -
var persistent real    rthblten ( nVertLevels nCells Time   ) 1  ro rthblten       tend_physics - -
var persistent real    rqvblten ( nVertLevels nCells Time   ) 1  ro rqvblten       tend_physics - -
var persistent real    rqcblten ( nVertLevels nCells Time   ) 1  ro rqcblten       tend_physics - -
var persistent real    rqiblten ( nVertLevels nCells Time   ) 1  ro rqiblten       tend_physics - -

%--------------------------------------------------------------------------------------------------
%... PARAMETERIZATION OF SURFACE LAYER PROCESSES:
%--------------------------------------------------------------------------------------------------

% br        :bulk richardson number                                                             [-]
% cd        :drag coefficient at 10m                                                            [-]
% cda       :drag coefficient at lowest model level                                             [-]
% chs       :???
% chs2      :???
% cqs2      :???
% ck        :enthalpy exchange coefficient at 10 m                                              [-]
% cka       :enthalpy exchange coefficient at lowest model level                                [-]
% cpm       :???
% flhc      :exchange coefficient for heat                                                      [-]
% flqc      :exchange coefficient for moisture                                                  [-]
% gz1oz0    :log of z1 over z0                                                                  [-]
% hfx       :upward heat flux at the surface                                               [W/m2/s]
% lh        :latent heat flux at the surface                                                 [W/m2]
% mavail    :surface moisture availability                                                      [-]
% mol       :T* in similarity theory                                                            [K]
% psih      :similarity theory for heat                                                         [-]
% psim      :similarity theory for momentum                                                     [-]
% qfx       :upward moisture flux at the surface                                          [kg/m2/s]
% qgh       :???
% qsfc      :specific humidity at lower boundary                                            [kg/kg]
% regime    :flag indicating PBL regime (stable_p,unstable_p,etc...)                            [-]
% rmol      :1 / Monin Ob length                                                                [-]
% ust       :u* in similarity theory                                                          [m/s]
% ustm      :u* in similarity theory without vconv                                            [m/s]
% zol       :z/L height over Monin-Obukhov length                                               [-]
% znt       :time-varying roughness length                                                      [m]
% wspd      :wind speed                                                                       [m/s]
% DIAGNOSTICS:
% q2        :specific humidity at 2m                                                        [kg/kg]
% u10       :u at 10 m                                                                        [m/s]
% v10       :v at 10 m                                                                        [m/s]
% t2m       :temperature at 2m                                                                  [K]
% th2m      :potential temperature at 2m                                                        [K]

var persistent real    hfx      ( nCells Time               ) 1  ro hfx            diag_physics - -
var persistent real    mavail   ( nCells Time               ) 1  ro mavail         diag_physics - -
var persistent real    mol      ( nCells Time               ) 1  ro mol            diag_physics - -
var persistent real    qfx      ( nCells Time               ) 1  ro qfx            diag_physics - -
var persistent real    qsfc     ( nCells Time               ) 1  ro qsfc           diag_physics - -
var persistent real    ust      ( nCells Time               ) 1  ro ust            diag_physics - -
var persistent real    ustm     ( nCells Time               ) 1  ro ustm           diag_physics - -
var persistent real    zol      ( nCells Time               ) 1  ro zol            diag_physics - -
var persistent real    znt      ( nCells Time               ) 1  ro znt            diag_physics - -

var persistent real    br       ( nCells Time               ) 1  ro br             diag_physics - -
var persistent real    cd       ( nCells Time               ) 1  ro cd             diag_physics - -
var persistent real    cda      ( nCells Time               ) 1  ro cda            diag_physics - -
var persistent real    chs      ( nCells Time               ) 1  ro chs            diag_physics - -
var persistent real    chs2     ( nCells Time               ) 1  ro chs2           diag_physics - -
var persistent real    cqs2     ( nCells Time               ) 1  ro cqs2           diag_physics - -
var persistent real    ck       ( nCells Time               ) 1  ro ck             diag_physics - -
var persistent real    cka      ( nCells Time               ) 1  ro cka            diag_physics - -
var persistent real    cpm      ( nCells Time               ) 1  ro cpm            diag_physics - -
var persistent real    flhc     ( nCells Time               ) 1  ro flhc           diag_physics - -
var persistent real    flqc     ( nCells Time               ) 1  ro flqc           diag_physics - -
var persistent real    gz1oz0   ( nCells Time               ) 1  ro gz1oz0         diag_physics - -
var persistent real    lh       ( nCells Time               ) 1  ro lh             diag_physics - -
var persistent real    psim     ( nCells Time               ) 1  ro psim           diag_physics - -
var persistent real    psih     ( nCells Time               ) 1  ro psih           diag_physics - -
var persistent real    qgh      ( nCells Time               ) 1  ro qgh            diag_physics - -
var persistent real    regime   ( nCells Time               ) 1  ro regime         diag_physics - -
var persistent real    rmol     ( nCells Time               ) 1  ro rmol           diag_physics - -
var persistent real    wspd     ( nCells Time               ) 1  ro wspd           diag_physics - -
% DIAGNOSTICS:
var persistent real    u10      ( nCells Time               ) 1  ro u10            diag_physics - -
var persistent real    v10      ( nCells Time               ) 1  ro v10            diag_physics - -
var persistent real    q2       ( nCells Time               ) 1  ro q2             diag_physics - -
var persistent real    t2m      ( nCells Time               ) 1  ro t2m            diag_physics - -
var persistent real    th2m     ( nCells Time               ) 1  ro th2m           diag_physics - -

%--------------------------------------------------------------------------------------------------
%... PARAMETERIZATION OF SHORTWAVE RADIATION:
%--------------------------------------------------------------------------------------------------
% coszr     :cosine of the solar zenith angle                                                   [-]
% gsw       :net shortwave flux at surface                                                  [W m-2]
% swcf      :shortwave cloud forcing at top-of-atmosphere                                   [W m-2]
% swdnb     :all-sky downwelling shortwave flux at bottom-of-atmosphere                     [W m-2]
% swdnbc    :clear-sky downwelling shortwave flux at bottom-of-atmosphere                   [W m-2]
% swdnt     :all-sky downwelling shortwave flux at top-of-atmosphere                        [W m-2]
% swdntc    :clear-sky downwelling shortwave flux at top-of-atmosphere                      [W m-2] 
% swupb     :all-sky upwelling shortwave flux at bottom-of-atmosphere                       [W m-2]
% swupbc    :clear-sky upwelling shortwave flux at bottom-of-atmosphere                     [W m-2]
% swupt     :all-sky upwelling shortwave flux at top-of-atmosphere                          [W m-2]
% swuptc    :clear-sky upwelling shortwave flux at top-of-atmosphere                        [W m-2]
% acswdnb   :accumulated all-sky downwelling shortwave flux at bottom-of-atmosphere         [J m-2]
% acswdnbc  :accumulated clear-sky downwelling shortwave flux at bottom-of-atmosphere       [J m-2]
% acswdnt   :accumulated all-sky downwelling shortwave flux at top-of-atmosphere            [J m-2]
% acswdntc  :accumulated clear-sky downwelling shortwave flux at top-of-atmosphere          [J m-2] 
% acswupb   :accumulated all-sky upwelling shortwave flux at bottom-of-atmosphere           [J m-2]
% acswupbc  :accumulated clear-sky upwelling shortwave flux at bottom-of-atmosphere         [J m-2]
% acswupt   :accumulated all-sky upwelling shortwave flux at top-of-atmosphere              [J m-2]
% acswuptc  :accumulated clear-sky upwelling shortwave flux at top-of-atmosphere            [J m-2]
% swdnflx   :
% swdnflxc  :
% swupflx   :
% swupflxc  :
% rthratensw:uncoupled theta tendency due to shortwave radiation                            [K s-1]

% i_acswdnb : counter related to how often swdnb is begin reset relative to its bucket value    (-)
% i_acswdnbc: counter related to how often swdnbc is begin reset relative to its bucket value   (-)
% i_acswdnt : counter related to how often swdnt is begin reset relative to its bucket value    (-)
% i_acswdntc: counter related to how often swdntc is begin reset relative to its bucket value   (-)
% i_acswupb : counter related to how often swupb is begin reset relative to its bucket value    (-)
% i_acswupbc: counter related to how often swupbc is begin reset relative to its bucket value   (-)
% i_acswupt : counter related to how often swupt is begin reset relative to its bucket value    (-)
% i_acswuptc: counter related to how often swuptc is begin reset relative to its bucket value   (-)

var persistent integer i_acswdnb  ( nCells Time               ) 1  ro i_acswdnb    diag_physics - -
var persistent integer i_acswdnbc ( nCells Time               ) 1  ro i_acswdnbc   diag_physics - -
var persistent integer i_acswdnt  ( nCells Time               ) 1  ro i_acswdnt    diag_physics - -
var persistent integer i_acswdntc ( nCells Time               ) 1  ro i_acswdntc   diag_physics - -
var persistent integer i_acswupb  ( nCells Time               ) 1  ro i_acswupb    diag_physics - -
var persistent integer i_acswupbc ( nCells Time               ) 1  ro i_acswupbc   diag_physics - -
var persistent integer i_acswupt  ( nCells Time               ) 1  ro i_acswupt    diag_physics - -
var persistent integer i_acswuptc ( nCells Time               ) 1  ro i_acswuptc   diag_physics - -

var persistent real    coszr      ( nCells Time               ) 1   o coszr        diag_physics - -
var persistent real    swcf       ( nCells Time               ) 1   o swcf         diag_physics - -
var persistent real    swdnb      ( nCells Time               ) 1   o swdnb        diag_physics - -
var persistent real    swdnbc     ( nCells Time               ) 1   o swdnbc       diag_physics - -
var persistent real    swdnt      ( nCells Time               ) 1   o swdnt        diag_physics - -
var persistent real    swdntc     ( nCells Time               ) 1   o swdntc       diag_physics - -
var persistent real    swupb      ( nCells Time               ) 1   o swupb        diag_physics - -
var persistent real    swupbc     ( nCells Time               ) 1   o swupbc       diag_physics - -
var persistent real    swupt      ( nCells Time               ) 1   o swupt        diag_physics - -
var persistent real    swuptc     ( nCells Time               ) 1   o swuptc       diag_physics - -
var persistent real    acswdnb    ( nCells Time               ) 1  ro acswdnb      diag_physics - -
var persistent real    acswdnbc   ( nCells Time               ) 1  ro acswdnbc     diag_physics - -
var persistent real    acswdnt    ( nCells Time               ) 1  ro acswdnt      diag_physics - -
var persistent real    acswdntc   ( nCells Time               ) 1  ro acswdntc     diag_physics - -
var persistent real    acswupb    ( nCells Time               ) 1  ro acswupb      diag_physics - -
var persistent real    acswupbc   ( nCells Time               ) 1  ro acswupbc     diag_physics - -
var persistent real    acswupt    ( nCells Time               ) 1  ro acswupt      diag_physics - -
var persistent real    acswuptc   ( nCells Time               ) 1  ro acswuptc     diag_physics - -
var persistent real    gsw        ( nCells Time               ) 1  ro gsw          diag_physics - -

var persistent real    rthratensw ( nVertLevels nCells Time   ) 1  ro rthratensw   tend_physics - -

%... RRTMG SW ONLY:
var persistent real    swdnflx    ( nVertLevelsP2 nCells Time ) 1   o swdnflx      diag_physics - -
var persistent real    swdnflxc   ( nVertLevelsP2 nCells Time ) 1   o swdnflxc     diag_physics - -
var persistent real    swupflx    ( nVertLevelsP2 nCells Time ) 1   o swupflx      diag_physics - -
var persistent real    swupflxc   ( nVertLevelsP2 nCells Time ) 1   o swupflxc     diag_physics - -

%--------------------------------------------------------------------------------------------------
%... PARAMETERIZATION OF LONGWAVE RADIATION:
%--------------------------------------------------------------------------------------------------

% note: glw is the same diagnostic as lwdnb and is used in the land-surface scheme for the calcula-
%       tion of the surface budget. glw is always an output argument to the subroutine rrtmg_lwrad.
%       in contrast,lwdnb is an optional ouput argument to the subroutine rrtmg_lwrad depending on
%       the presence of lwupt (or not).

% glw       :all-sky downwelling longwave flux at bottom-of-atmosphere                      [W m-2]
% lwcf      :longwave cloud forcing at top-of-atmosphere                                    [W m-2]
% lwdnb     :all-sky downwelling longwave flux at bottom-of-atmosphere                      [W m-2]
% lwdnbc    :clear-sky downwelling longwave flux at bottom-of-atmosphere                    [W m-2]
% lwdnt     :all-sky downwelling longwave flux at top-of-atmosphere                         [W m-2]
% lwdntc    :clear-sky downwelling longwave flux at top-of-atmosphere                       [W m-2]
% lwupb     :all-sky upwelling longwave flux at bottom-of-atmosphere                        [W m-2]
% lwupbc    :clear-sky upwelling longwave flux at bottom-of-atmosphere                      [W m-2]
% lwupt     :all-sky upwelling longwave flux at top-of-atmosphere                           [W m-2]
% lwuptc    :clear-sky upwelling longwave flux at top-of-atmosphere                         [W m-2]
% aclwdnb   :accumulated all-sky downwelling longwave flux at bottom-of-atmosphere          [J m-2]
% aclwdnbc  :accumulated clear-sky downwelling longwave flux at bottom-of-atmosphere        [J m-2]
% aclwdnt   :accumulated all-sky downwelling longwave flux at top-of-atmosphere             [J m-2]
% aclwdntc  :accumulated clear-sky downwelling longwave flux at top-of-atmosphere           [J m-2]
% aclwupb   :accumulated all-sky upwelling longwave flux at bottom-of-atmosphere            [J m-2]
% aclwupbc  :accumulated clear-sky upwelling longwave flux at bottom-of-atmosphere          [J m-2]
% aclwupt   :accumulated all-sky upwelling longwave flux at top-of-atmosphere               [J m-2]
% aclwuptc  :accumulated clear-sky upwelling longwave flux at top-of-atmosphere             [J m-2]
% lwdnflx   :
% lwdnflxc  :
% lwupflx   :
% lwupflxc  :
% olrtoa    :outgoing longwave radiation at top-of-the-atmosphere                           [W m-2]
% rthratenlw:uncoupled theta tendency due to longwave radiation                             [K s-1]

% i_aclwdnb : counter related to how often lwdnb is begin reset relative to its bucket value    (-)
% i_aclwdnbc: counter related to how often lwdnbc is begin reset relative to its bucket value   (-)
% i_aclwdnt : counter related to how often lwdnt is begin reset relative to its bucket value    (-)
% i_aclwdntc: counter related to how often lwdntc is begin reset relative to its bucket value   (-)
% i_aclwupb : counter related to how often lwupb is begin reset relative to its bucket value    (-)
% i_aclwupbc: counter related to how often lwupbc is begin reset relative to its bucket value   (-)
% i_aclwupt : counter related to how often lwupt is begin reset relative to its bucket value    (-)
% i_aclwuptc: counter related to how often lwuptc is begin reset relative to its bucket value   (-)

var persistent integer i_aclwdnb  ( nCells Time               ) 1  ro i_aclwdnb    diag_physics - -
var persistent integer i_aclwdnbc ( nCells Time               ) 1  ro i_aclwdnbc   diag_physics - -
var persistent integer i_aclwdnt  ( nCells Time               ) 1  ro i_aclwdnt    diag_physics - -
var persistent integer i_aclwdntc ( nCells Time               ) 1  ro i_aclwdntc   diag_physics - -
var persistent integer i_aclwupb  ( nCells Time               ) 1  ro i_aclwupb    diag_physics - -
var persistent integer i_aclwupbc ( nCells Time               ) 1  ro i_aclwupbc   diag_physics - -
var persistent integer i_aclwupt  ( nCells Time               ) 1  ro i_aclwupt    diag_physics - -
var persistent integer i_aclwuptc ( nCells Time               ) 1  ro i_aclwuptc   diag_physics - -

var persistent real    lwcf       ( nCells Time               ) 1   o lwcf         diag_physics - -
var persistent real    lwdnb      ( nCells Time               ) 1   o lwdnb        diag_physics - -
var persistent real    lwdnbc     ( nCells Time               ) 1   o lwdnbc       diag_physics - -
var persistent real    lwdnt      ( nCells Time               ) 1   o lwdnt        diag_physics - -
var persistent real    lwdntc     ( nCells Time               ) 1   o lwdntc       diag_physics - -
var persistent real    lwupb      ( nCells Time               ) 1   o lwupb        diag_physics - -
var persistent real    lwupbc     ( nCells Time               ) 1   o lwupbc       diag_physics - -
var persistent real    lwupt      ( nCells Time               ) 1   o lwupt        diag_physics - -
var persistent real    lwuptc     ( nCells Time               ) 1   o lwuptc       diag_physics - -
var persistent real    aclwdnb    ( nCells Time               ) 1  ro aclwdnb      diag_physics - -
var persistent real    aclwdnbc   ( nCells Time               ) 1  ro aclwdnbc     diag_physics - -
var persistent real    aclwdnt    ( nCells Time               ) 1  ro aclwdnt      diag_physics - -
var persistent real    aclwdntc   ( nCells Time               ) 1  ro aclwdntc     diag_physics - -
var persistent real    aclwupb    ( nCells Time               ) 1  ro aclwupb      diag_physics - -
var persistent real    aclwupbc   ( nCells Time               ) 1  ro aclwupbc     diag_physics - -
var persistent real    aclwupt    ( nCells Time               ) 1  ro aclwupt      diag_physics - -
var persistent real    aclwuptc   ( nCells Time               ) 1  ro aclwuptc     diag_physics - -
var persistent real    olrtoa     ( nCells Time               ) 1   o olrtoa       diag_physics - -
var persistent real    glw        ( nCells Time               ) 1  ro glw          diag_physics - -

var persistent real    rthratenlw ( nVertLevels nCells Time   ) 1  ro rthratenlw   tend_physics - -

%... RRTMG LW ONLY:
%var persistent real   lwdnflx    ( nVertLevelsP2 nCells Time ) 1   o lwdnflx      diag_physics - -
%var persistent real   lwdnflxc   ( nVertLevelsP2 nCells Time ) 1   o lwdnflxc     diag_physics - -
%var persistent real   lwupflx    ( nVertLevelsP2 nCells Time ) 1   o lwupflx      diag_physics - -
%var persistent real   lwupflxc   ( nVertLevelsP2 nCells Time ) 1   o lwupflxc     diag_physics - -

%--------------------------------------------------------------------------------------------------
%... ADDITIONAL "RADIATION" ARRAYS NEEDED ONLY IN THE "CAM" LW AND SW RADIATION CODES:
%--------------------------------------------------------------------------------------------------

%INFRARED ABSORPTION:
var persistent real absnxt  ( nVertLevels   cam_dim1      nCells Time ) 1 - absnxt diag_physics - -
var persistent real abstot  ( nVertLevelsP1 nVertLevelsP1 nCells Time ) 1 - abstot diag_physics - -
var persistent real emstot  ( nVertLevelsP1 nCells Time               ) 1 - emstot diag_physics - -
%var persistent real absnxt ( nVertLevels   cam_dim1      nCells Time ) 1 r absnxt diag_physics - -
%var persistent real abstot ( nVertLevelsP1 nVertLevelsP1 nCells Time ) 1 r abstot diag_physics - -
%var persistent real emstot ( nVertLevelsP1 nCells Time               ) 1 r emstot diag_physics - -

% OZONE:
var persistent real    pin      ( nOznLevels nCells         ) 0 -  pin       mesh  - -
var persistent real    ozmixm   ( nMonths nOznLevels nCells ) 0 -  ozmixm    mesh  - -

% AEROSOLS:
var persistent real    m_hybi   ( nAerLevels nCells         ) 0 -  m_hybi    mesh  - -  

var persistent real    m_ps     ( nCells Time               ) 2 -  m_ps      state - -
%var persistent real   dummy    ( nAerLevels nCells Time    ) 2 -  dummy     state aerosols aer_cam
var persistent real    sul      ( nAerLevels nCells Time    ) 2 -  sul       state aerosols aer_cam
var persistent real    sslt     ( nAerLevels nCells Time    ) 2 -  sslt      state aerosols aer_cam
var persistent real    dust1    ( nAerLevels nCells Time    ) 2 -  dust1     state aerosols aer_cam
var persistent real    dust2    ( nAerLevels nCells Time    ) 2 -  dust2     state aerosols aer_cam
var persistent real    dust3    ( nAerLevels nCells Time    ) 2 -  dust3     state aerosols aer_cam
var persistent real    dust4    ( nAerLevels nCells Time    ) 2 -  dust4     state aerosols aer_cam
var persistent real    ocpho    ( nAerLevels nCells Time    ) 2 -  ocpho     state aerosols aer_cam
var persistent real    bcpho    ( nAerLevels nCells Time    ) 2 -  bcpho     state aerosols aer_cam
var persistent real    ocphi    ( nAerLevels nCells Time    ) 2 -  ocphi     state aerosols aer_cam
var persistent real    bcphi    ( nAerLevels nCells Time    ) 2 -  bcphi     state aerosols aer_cam
var persistent real    bg       ( nAerLevels nCells Time    ) 2 -  bg        state aerosols aer_cam
var persistent real    volc     ( nAerLevels nCells Time    ) 2 -  volc      state aerosols aer_cam

%--------------------------------------------------------------------------------------------------
%... PARAMERIZATION OF CLOUDINESS:
%--------------------------------------------------------------------------------------------------

% cldfrac   :cloud fraction                                                                     [-]

var persistent real    cldfrac    ( nVertLevels nCells Time ) 1   o cldfrac        diag_physics - -

%--------------------------------------------------------------------------------------------------
%... PARAMETERIZATION OF LAND-SURFACE SCHEME:
%--------------------------------------------------------------------------------------------------

% acsnom         :accumulated melted snow                                                  [kg m-2]
% acsnow         :accumulated snow                                                         [kg m-2]
% canwat         :canopy water                                                             [kg m-2]
% chklowq        :surface saturation flag                                                       [-]
% grdflx         :ground heat flux                                                          [W m-2]
% lai            :leaf area index                                                               [-]
% noahres        :residual of the noah land-surface scheme energy budget                    [W m-2]
% potevp         :potential evaporation                                                     [W m-2]
% qz0            :specific humidity at znt                                                [kg kg-1]
% rib            :??
% sfc_albedo     :surface albedo                                                                [-]
% sfc_embck      :background emissivity                                                         [-]
% sfc_emiss      :surface emissivity                                                            [-]
% sfcrunoff      :surface runoff                                                            [m s-1]
% smstav         :moisture availability                                                         [-]
% smstot         :total moisture                                                           [m3 m-3]
% snopcx         :snow phase change heat flux                                               [W m-2]
% snotime        :??
% sstsk          : skin sea-surface temperature                                                [K]
% sstsk_diur     : skin sea-surface temperature difference                                     [K]
% thc            :thermal inertia                                              [Cal cm-1 K-1 s-0.5]
% udrunoff       :sub-surface runoff                                                        [m s-1]
% xicem          :ice mask from previous time-step                                              [-]
% z0             :background roughness length                                                   [m]
% zs             :depth of centers of soil layers                                               [m]

var persistent real    acsnom     ( nCells Time             ) 1  ro acsnom         diag_physics - -
var persistent real    acsnow     ( nCells Time             ) 1  ro acsnow         diag_physics - -
var persistent real    canwat     ( nCells Time             ) 1  ro canwat         diag_physics - -
var persistent real    chklowq    ( nCells Time             ) 1  ro chklowq        diag_physics - -
var persistent real    grdflx     ( nCells Time             ) 1  ro grdflx         diag_physics - -
var persistent real    lai        ( nCells Time             ) 1  ro lai            diag_physics - -
var persistent real    noahres    ( nCells Time             ) 1  ro noahres        diag_physics - -
var persistent real    potevp     ( nCells Time             ) 1  ro potevp         diag_physics - -
var persistent real    qz0        ( nCells Time             ) 1  ro qz0            diag_physics - -
var persistent real    rib        ( nCells Time             ) 1  ro rib            diag_physics - -
var persistent real    sfc_albedo ( nCells Time             ) 1  ro sfc_albedo     diag_physics - -
var persistent real    sfc_emiss  ( nCells Time             ) 1  ro sfc_emiss      diag_physics - -
var persistent real    sfc_emibck ( nCells Time             ) 1  ro sfc_emibck     diag_physics - -
var persistent real    sfcrunoff  ( nCells Time             ) 1  ro sfcrunoff      diag_physics - -   
var persistent real    smstav     ( nCells Time             ) 1  ro smstav         diag_physics - -   
var persistent real    smstot     ( nCells Time             ) 1  ro smstot         diag_physics - -   
var persistent real    snopcx     ( nCells Time             ) 1  ro snopcx         diag_physics - -
var persistent real    snotime    ( nCells Time             ) 1  ro snotime        diag_physics - -
var persistent real    sstsk      ( nCells Time             ) 1  ro sstsk          diag_physics - -
var persistent real    sstsk_diur ( nCells Time             ) 1  ro sstsk_diur     diag_physics - -
var persistent real    thc        ( nCells Time             ) 1  ro thc            diag_physics - - 
var persistent real    udrunoff   ( nCells Time             ) 1  ro udrunoff       diag_physics - -   
var persistent real    xicem      ( nCells Time             ) 1  ro xicem          diag_physics - -
var persistent real    z0         ( nCells Time             ) 1  ro z0             diag_physics - -   
var persistent real    zs         ( nCells Time             ) 1  ro zs             diag_physics - -   

%--------------------------------------------------------------------------------------------------
%... SURFACE CHARACTERISTICS THAT NEED TO BE READ FROM GRID.NC:
%--------------------------------------------------------------------------------------------------

% albedo12m      :monthly climatological albedo                                                 [-]
% greenfrac      :monthly climatological greeness fraction                                      [-]                             
% isltyp         :dominant soil category                                                        [-]
% ivgtyp         :dominant vegetation category                                                  [-]
% landmask       :=0 for ocean;=1 for land                                                      [-]
% sfc_albbck     :background albedo                                                             [-]
% shdmin         :minimum areal fractional coverage of annual green vegetation                  [-]
% shdmax         :maximum areal fractional coverage of annual green vegetation                  [-]
% skintemp       :skin temperature                                                              [K]
% snoalb         :annual max snow albedo                                                        [-]
% snow           :snow water equivalent                                                    [kg m-2]
% sst            :sea-surface temperature                                                       [K]
% snowc          :flag indicating snow coverage (1 for snow cover)                              [-]
% snowh          :physical snow depth                                                           [m]
% ter            :terrain height                                                                [-]
% tmn            :soil temperature at lower boundary                                            [K]
% vegfra         :vegetation fraction                                                           [-]
% seaice         :sea-ice mask (=1 when xice is greater than 0; =0 otherwise)                   [-]
% xice           :fractional sea-ice coverage                                                   [-]
% xland          :land mask    (1 for land; 2 for water)                                        [-]

% dzs            :thickness of soil layers                                                      [m]
% smcrel         :soil moisture threshold below which transpiration begins to stress            [-]
% sh2o           :soil liquid water                                                        [m3 m-3]
% smois          :soil moisture                                                            [m3 m-3]
% tslb           :soil temperature                                                              [K]

var persistent integer isltyp     ( nCells                   ) 0 iro isltyp        sfc_input    - -
var persistent integer ivgtyp     ( nCells                   ) 0 iro ivgtyp        sfc_input    - -
var persistent integer landmask   ( nCells                   ) 0 iro landmask      sfc_input    - -
var persistent real    shdmin     ( nCells                   ) 0 iro shdmin        sfc_input    - -
var persistent real    shdmax     ( nCells                   ) 0 iro shdmax        sfc_input    - -
var persistent real    snoalb     ( nCells                   ) 0 iro snoalb        sfc_input    - -
var persistent real    ter        ( nCells                   ) 0 io  ter           sfc_input    - -
var persistent real    albedo12m  ( nMonths nCells           ) 0 iro albedo12m     sfc_input    - -
var persistent real    greenfrac  ( nMonths nCells           ) 0 iro greenfrac     sfc_input    - -

var persistent real    sfc_albbck ( nCells Time              ) 1 iro sfc_albbck    sfc_input    - -
var persistent real    skintemp   ( nCells Time              ) 1 iro skintemp      sfc_input    - -
var persistent real    snow       ( nCells Time              ) 1 iro snow          sfc_input    - -
var persistent real    snowc      ( nCells Time              ) 1 iro snowc         sfc_input    - -
var persistent real    snowh      ( nCells Time              ) 1 iro snowh         sfc_input    - -
var persistent real    sst        ( nCells Time              ) 1 isro sst          sfc_input    - -
var persistent real    tmn        ( nCells Time              ) 1 iro tmn           sfc_input    - -
var persistent real    vegfra     ( nCells Time              ) 1 iro vegfra        sfc_input    - -   
var persistent real    seaice     ( nCells Time              ) 1 iro seaice        sfc_input    - -
var persistent real    xice       ( nCells Time              ) 1 isro xice         sfc_input    - -
var persistent real    xland      ( nCells Time              ) 1 iro xland         sfc_input    - -

var persistent real    dzs        ( nSoilLevels nCells Time  ) 1 iro dzs           sfc_input    - -
var persistent real    smcrel     ( nSoilLevels nCells Time  ) 1  ro smcrel        sfc_input    - -
var persistent real    sh2o       ( nSoilLevels nCells Time  ) 1 iro sh2o          sfc_input    - -
var persistent real    smois      ( nSoilLevels nCells Time  ) 1 iro smois         sfc_input    - -
var persistent real    tslb       ( nSoilLevels nCells Time  ) 1 iro tslb          sfc_input    - -

%==================================================================================================

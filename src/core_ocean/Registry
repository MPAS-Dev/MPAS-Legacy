%
% namelist  type  namelist_record  name  default_value
%
namelist logical   time_management config_do_restart          .false.
namelist character time_management config_start_time          '0000-01-01_00:00:00'
namelist character time_management config_stop_time           'none'
namelist character time_management config_run_duration        'none'
namelist character time_management config_calendar_type       '360day'
namelist integer   time_management config_ncouple_per_day       1

namelist character io       config_input_name          'grid.nc'
namelist character io       config_output_name         'output.nc'
namelist character io       config_restart_name        'restart.nc'
namelist character io       config_restart_interval    'none'
namelist character io       config_output_interval     '24:00:00'
namelist character io       config_stats_interval      '24:00:00'
namelist logical   io       config_write_stats_on_startup   .false.
namelist logical   io       config_write_output_on_startup  .true.
namelist integer   io       config_frames_per_outfile  0
namelist integer   io       config_pio_num_iotasks     0 
namelist integer   io       config_pio_stride          1

namelist real      time_integration config_dt                  172.8
namelist character time_integration config_time_integrator    'RK4'

namelist integer   grid config_num_halos           3
namelist logical   grid config_enforce_grid_on_restart .false.
namelist character grid config_vert_coord_movement      'isopycnal'
namelist character grid config_alter_ICs_for_pbcs 'zlevel_pbcs_off'
namelist real      grid config_min_pbc_fraction  0.10
namelist logical   grid config_check_ssh_consistency .true.

namelist character decomposition config_block_decomp_file_prefix  'graph.info.part.'
namelist integer   decomposition config_number_of_blocks          0
namelist logical   decomposition config_explicit_proc_decomp      .false.
namelist character decomposition config_proc_decomp_file_prefix   'graph.info.part.'

namelist logical   hmix          config_h_ScaleWithMesh     .false.
namelist logical   hmix          config_visc_vorticity_term .true.
namelist real      hmix          config_apvm_scale_factor      0.0

namelist logical   hmix_del2     config_use_mom_del2     .true.
namelist logical   hmix_del2     config_use_tracer_del2     .true.
namelist real      hmix_del2     config_h_mom_eddy_visc2     0.0
namelist real      hmix_del2     config_h_tracer_eddy_diff2  0.0
namelist real      hmix_del2     config_visc_vorticity_visc2_scale 1.0

namelist logical   hmix_del4     config_use_mom_del4     .true.
namelist logical   hmix_del4     config_use_tracer_del4     .true.
namelist real      hmix_del4     config_h_mom_eddy_visc4     0.0
namelist real      hmix_del4     config_h_tracer_eddy_diff4  0.0
namelist real      hmix_del4     config_visc_vorticity_visc4_scale 1.0

namelist logical   hmix_Leith    config_use_Leith_del2         .false.
namelist real      hmix_Leith    config_Leith_parameter        0.0
namelist real      hmix_Leith    config_Leith_dx               0.0
namelist real      hmix_Leith    config_Leith_visc2_max      1000000.0

namelist real      standard_GM     config_h_kappa              0.0
namelist real      standard_GM     config_h_kappa_q            0.0

namelist logical   Rayleigh_damping     config_Rayleigh_friction    .false.
namelist real      Rayleigh_damping     config_Rayleigh_damping_coeff 0.0

namelist logical   vmix     config_implicit_vertical_mix  .true.
namelist real      vmix     config_convective_visc      1.0
namelist real      vmix     config_convective_diff      1.0

namelist logical   vmix_const   config_use_const_visc   .true.
namelist logical   vmix_const   config_use_const_diff   .true.
namelist real      vmix_const   config_vert_visc        2.5e-4
namelist real      vmix_const   config_vert_diff        2.5e-5

namelist logical   vmix_rich    config_use_rich_visc    .true.
namelist logical   vmix_rich    config_use_rich_diff    .true.
namelist real      vmix_rich    config_bkrd_vert_visc   1.0e-4
namelist real      vmix_rich    config_bkrd_vert_diff   1.0e-5
namelist real      vmix_rich    config_rich_mix         0.005

namelist logical   vmix_tanh    config_use_tanh_visc    .true.
namelist logical   vmix_tanh    config_use_tanh_diff    .true.
namelist real      vmix_tanh    config_max_visc_tanh    2.5e-1
namelist real      vmix_tanh    config_min_visc_tanh    1.0e-4
namelist real      vmix_tanh    config_max_diff_tanh    2.5e-2
namelist real      vmix_tanh    config_min_diff_tanh    1.0e-5
namelist real      vmix_tanh    config_zMid_tanh        -100
namelist real      vmix_tanh    config_zWidth_tanh      100

namelist logical   forcing   config_use_monthly_forcing .false.
namelist logical   forcing   config_restoreTS           .false.
namelist real      forcing   config_restoreT_timescale  90.0
namelist real      forcing   config_restoreS_timescale  90.0

namelist character advection config_vert_tracer_adv     'stencil'
namelist integer   advection config_vert_tracer_adv_order  4
namelist integer   advection config_horiz_tracer_adv_order 2
namelist real      advection config_coef_3rd_order      0.25
namelist logical   advection config_monotonic           .false.

namelist real      bottom_drag config_bottom_drag_coeff    1.0e-3

namelist character pressure_gradient     config_pressure_gradient_type       'pressure_and_zmid'
namelist real      pressure_gradient     config_rho0                1014.65

namelist character eos       config_eos_type            'linear'

namelist integer   split_explicit_ts config_n_ts_iter     2
namelist integer   split_explicit_ts config_n_bcl_iter_beg   2
namelist integer   split_explicit_ts config_n_bcl_iter_mid   2
namelist integer   split_explicit_ts config_n_bcl_iter_end   2
namelist integer   split_explicit_ts config_n_btr_subcycles  20
namelist integer   split_explicit_ts config_n_btr_cor_iter  2
namelist logical   split_explicit_ts config_u_correction .true.
namelist integer   split_explicit_ts config_btr_subcycle_loop_factor  2
namelist real      split_explicit_ts config_btr_gam1_uWt1    0.5
namelist real      split_explicit_ts config_btr_gam2_SSHWt1  1.0
namelist real      split_explicit_ts config_btr_gam3_uWt2    1.0
namelist logical   split_explicit_ts config_btr_solve_SSH2   .false.

namelist integer   sw_model config_test_case           0

namelist logical   debug config_check_zlevel_consistency .false.
namelist logical   debug config_filter_btr_mode .false.
namelist logical   debug config_prescribe_velocity  .false.
namelist logical   debug config_prescribe_thickness .false.
namelist logical   debug config_include_KE_vertex .false.
namelist logical   debug config_check_tracer_monotonicity  .false.
namelist logical   debug config_disable_h_all_tend .false.
namelist logical   debug config_disable_h_hadv .false.
namelist logical   debug config_disable_h_vadv .false.
namelist logical   debug config_disable_u_all_tend .false.
namelist logical   debug config_disable_u_coriolis .false.
namelist logical   debug config_disable_u_pgrad .false.
namelist logical   debug config_disable_u_hmix .false.
namelist logical   debug config_disable_u_windstress .false.
namelist logical   debug config_disable_u_vmix .false.
namelist logical   debug config_disable_u_vadv .false.
namelist logical   debug config_disable_tr_all_tend .false.
namelist logical   debug config_disable_tr_adv .false.
namelist logical   debug config_disable_tr_hmix .false.
namelist logical   debug config_disable_tr_vmix .false.

%
% dim  type  name_in_file  name_in_code
%
dim nCells nCells
dim nEdges nEdges
dim maxEdges maxEdges
dim maxEdges2 maxEdges2
dim nAdvectionCells maxEdges2+0
dim nVertices nVertices
dim TWO 2
dim R3 3
dim FIFTEEN 15
dim TWENTYONE 21
dim vertexDegree vertexDegree
dim nVertLevels nVertLevels
dim nVertLevelsP1 nVertLevels+1
dim nMonths nMonths

%
% var persistence type  name_in_file  ( dims )  time_levs iro-  name_in_code struct super-array array_class
%
var persistent text    xtime ( Time ) 2 ro xtime state - -

var persistent real    latCell ( nCells ) 0 iro latCell mesh - -
var persistent real    lonCell ( nCells ) 0 iro lonCell mesh - -
var persistent real    xCell ( nCells ) 0 iro xCell mesh - -
var persistent real    yCell ( nCells ) 0 iro yCell mesh - -
var persistent real    zCell ( nCells ) 0 iro zCell mesh - -
var persistent integer indexToCellID ( nCells ) 0 iro indexToCellID mesh - -

var persistent real    latEdge ( nEdges ) 0 iro latEdge mesh - -
var persistent real    lonEdge ( nEdges ) 0 iro lonEdge mesh - -
var persistent real    xEdge ( nEdges ) 0 iro xEdge mesh - -
var persistent real    yEdge ( nEdges ) 0 iro yEdge mesh - -
var persistent real    zEdge ( nEdges ) 0 iro zEdge mesh - -
var persistent integer indexToEdgeID ( nEdges ) 0 iro indexToEdgeID mesh - -

var persistent real    latVertex ( nVertices ) 0 iro latVertex mesh - -
var persistent real    lonVertex ( nVertices ) 0 iro lonVertex mesh - -
var persistent real    xVertex ( nVertices ) 0 iro xVertex mesh - -
var persistent real    yVertex ( nVertices ) 0 iro yVertex mesh - -
var persistent real    zVertex ( nVertices ) 0 iro zVertex mesh - -
var persistent integer indexToVertexID ( nVertices ) 0 iro indexToVertexID mesh - -

var persistent real    meshDensity ( nCells ) 0 iro meshDensity mesh - -
var persistent real    meshScalingDel2 ( nEdges ) 0 ro meshScalingDel2 mesh - -
var persistent real    meshScalingDel4 ( nEdges ) 0 ro meshScalingDel4 mesh - -
var persistent real    meshScaling ( nEdges ) 0 ro meshScaling mesh - -

var persistent integer cellsOnEdge ( TWO nEdges ) 0 iro cellsOnEdge mesh - -
var persistent integer nEdgesOnCell ( nCells ) 0 iro nEdgesOnCell mesh - -
var persistent integer nEdgesOnEdge ( nEdges ) 0 iro nEdgesOnEdge mesh - -
var persistent integer edgesOnCell ( maxEdges nCells ) 0 iro edgesOnCell mesh - -
var persistent integer edgesOnEdge ( maxEdges2 nEdges ) 0 iro edgesOnEdge mesh - -

var persistent real    weightsOnEdge ( maxEdges2 nEdges ) 0 iro weightsOnEdge mesh - -
var persistent real    dvEdge ( nEdges ) 0 iro dvEdge mesh - -
var persistent real    dcEdge ( nEdges ) 0 iro dcEdge mesh - -
var persistent real    angleEdge ( nEdges ) 0 iro angleEdge mesh - -
var persistent real    areaCell ( nCells ) 0 iro areaCell mesh - -
var persistent real    areaTriangle ( nVertices ) 0 iro areaTriangle mesh - -

var persistent real    edgeNormalVectors ( R3 nEdges ) 0 o edgeNormalVectors mesh - -
var persistent real    localVerticalUnitVectors ( R3 nCells ) 0 o localVerticalUnitVectors mesh - -
var persistent real    cellTangentPlane ( R3 TWO nEdges ) 0 o cellTangentPlane mesh - -

var persistent integer cellsOnCell ( maxEdges nCells ) 0 iro cellsOnCell mesh - -
var persistent integer verticesOnCell ( maxEdges nCells ) 0 iro verticesOnCell mesh - -
var persistent integer verticesOnEdge ( TWO nEdges ) 0 iro verticesOnEdge mesh - -
var persistent integer edgesOnVertex ( vertexDegree nVertices ) 0 iro edgesOnVertex mesh - -
var persistent integer cellsOnVertex ( vertexDegree nVertices ) 0 iro cellsOnVertex mesh - -
var persistent real    kiteAreasOnVertex ( vertexDegree nVertices ) 0 iro kiteAreasOnVertex mesh - -
var persistent real    fEdge ( nEdges ) 0 iro fEdge mesh - -
var persistent real    fVertex ( nVertices ) 0 iro fVertex mesh - -
var persistent real    bottomDepth ( nCells ) 0 iro bottomDepth mesh - -

% Space needed for advection
var persistent real    deriv_two ( maxEdges2 TWO nEdges ) 0 - deriv_two mesh - -

% Added for monotonic advection scheme
var persistent real    adv_coefs ( nAdvectionCells nEdges ) 0 - adv_coefs mesh - -
var persistent real    adv_coefs_2nd ( nAdvectionCells nEdges ) 0 - adv_coefs_2nd mesh - -
var persistent real    adv_coefs_3rd ( nAdvectionCells nEdges ) 0 - adv_coefs_3rd mesh - -
var persistent integer advCellsForEdge ( nAdvectionCells nEdges ) 0 - advCellsForEdge mesh - -
var persistent integer nAdvCellsForEdge ( nEdges ) 0 - nAdvCellsForEdge mesh - -
var persistent integer highOrderAdvectionMask ( nVertLevels nEdges ) 0 - highOrderAdvectionMask mesh - -
var persistent integer lowOrderAdvectionMask ( nVertLevels nEdges ) 0 - lowOrderAdvectionMask mesh - -

% !! NOTE: the following arrays are needed to allow the use
% !! of the module_advection.F w/o alteration
% Space needed for deformation calculation weights
var persistent real    defc_a ( maxEdges nCells ) 0 - defc_a mesh - -
var persistent real    defc_b ( maxEdges nCells ) 0 - defc_b mesh - -
var persistent real    kdiff ( nVertLevels nCells Time ) 0 - kdiff mesh - -

% Arrays required for reconstruction of velocity field
var persistent real    coeffs_reconstruct ( R3 maxEdges nCells ) 0 - coeffs_reconstruct mesh - -

% Arrays for non-isopycnal version of mpas-ocean
var persistent integer maxLevelCell ( nCells ) 0 iro maxLevelCell mesh - -
var persistent integer maxLevelEdgeTop ( nEdges ) 0 - maxLevelEdgeTop mesh - -
var persistent integer maxLevelEdgeBot ( nEdges ) 0 - maxLevelEdgeBot mesh - -
var persistent integer maxLevelVertexTop ( nVertices ) 0 - maxLevelVertexTop mesh - -
var persistent integer maxLevelVertexBot ( nVertices ) 0 - maxLevelVertexBot mesh - -
var persistent real refBottomDepth ( nVertLevels ) 0 iro refBottomDepth mesh - -
var persistent real refBottomDepthTopOfCell ( nVertLevelsP1 ) 0 - refBottomDepthTopOfCell mesh - -
var persistent real hZLevel ( nVertLevels ) 0 iro hZLevel mesh - -
var persistent real vertCoordMovementWeights ( nVertLevels ) 0 iro vertCoordMovementWeights mesh - -

% Boundary conditions and masks
var persistent integer boundaryEdge ( nVertLevels nEdges ) 0 - boundaryEdge mesh - -
var persistent integer boundaryVertex ( nVertLevels nVertices ) 0 - boundaryVertex mesh - -
var persistent integer boundaryCell ( nVertLevels nCells ) 0 - boundaryCell mesh - -
var persistent integer edgeMask ( nVertLevels nEdges ) 0 o edgeMask mesh - -
var persistent integer vertexMask ( nVertLevels nVertices ) 0 o vertexMask mesh - -
var persistent integer cellMask ( nVertLevels nCells ) 0 o cellMask mesh - -

% Forcing variables.  
var persistent real    u_src ( nVertLevels nEdges ) 0 ir u_src mesh - -
var persistent real    temperatureRestore ( nCells ) 0 ir temperatureRestore mesh - -
var persistent real    salinityRestore ( nCells ) 0 ir salinityRestore mesh - -
var persistent real    windStressMonthly ( nMonths nEdges ) 0 ir windStressMonthly mesh - -
var persistent real    temperatureRestoreMonthly ( nMonths nCells ) 0 ir temperatureRestoreMonthly mesh - -
var persistent real    salinityRestoreMonthly ( nMonths nCells ) 0 ir salinityRestoreMonthly mesh - -

% Prognostic variables: read from input, saved in restart, and written to output
var persistent real    u ( nVertLevels nEdges Time ) 2 ir u state - -
var persistent real    h ( nVertLevels nCells Time ) 2 iro h state - -
var persistent real    rho ( nVertLevels nCells Time ) 2 iro rho state - -
var persistent real    temperature ( nVertLevels nCells Time ) 2 iro temperature state tracers dynamics
var persistent real    salinity ( nVertLevels nCells Time ) 2 iro salinity state tracers dynamics
var persistent real    tracer1 ( nVertLevels nCells Time ) 2 iro tracer1 state tracers testing

% Tendency variables: neither read nor written to any files
var persistent real    tend_u ( nVertLevels nEdges Time ) 1 - u tend - -
var persistent real    tend_h ( nVertLevels nCells Time ) 1 - h tend - -
var persistent real    tend_ssh ( nCells Time ) 1 - ssh tend - -
var persistent real    tend_temperature ( nVertLevels nCells Time ) 1 - temperature tend tracers dynamics
var persistent real    tend_salinity ( nVertLevels nCells Time ) 1 - salinity tend tracers dynamics
var persistent real    tend_tracer1 ( nVertLevels nCells Time ) 1 - tracer1 tend tracers testing

% state variables for Split Explicit timesplitting
var persistent real   uBtr ( nEdges Time )         2 r  uBtr state - -
var persistent real   ssh ( nCells Time )          2 o  ssh state - - 
var persistent real   uBtrSubcycle ( nEdges Time ) 2 -  uBtrSubcycle state - -
var persistent real   sshSubcycle ( nCells Time )  2 -  sshSubcycle state - - 
var persistent real   FBtr ( nEdges Time )         2 -  FBtr state - - 
var persistent real   GBtrForcing ( nEdges Time )  2 -  GBtrForcing state - -
var persistent real   uBcl ( nVertLevels nEdges Time )  2 - uBcl state - - 

% Diagnostic fields: only written to output
var persistent real    zMid ( nVertLevels nCells Time ) 2 - zMid state - -
var persistent real    v ( nVertLevels nEdges Time ) 2 - v state - -
var persistent real    uTransport ( nVertLevels nEdges Time ) 2 - uTransport state - -
var persistent real    uBolusGM ( nVertLevels nEdges Time ) 2 - uBolusGM state - -
var persistent real    uBolusGMX ( nVertLevels nEdges Time ) 2 - uBolusGMX state - -
var persistent real    uBolusGMY ( nVertLevels nEdges Time ) 2 - uBolusGMY state - -
var persistent real    uBolusGMZ ( nVertLevels nEdges Time ) 2 - uBolusGMZ state - -
var persistent real    uBolusGMZonal ( nVertLevels nEdges Time ) 2 o uBolusGMZonal state - -
var persistent real    uBolusGMMeridional ( nVertLevels nEdges Time ) 2 o uBolusGMMeridional state - -
var persistent real    hEddyFlux ( nVertLevels nEdges Time ) 2 - hEddyFlux state - -
var persistent real    h_kappa ( nVertLevels nEdges Time ) 2 - h_kappa state - -
var persistent real    h_kappa_q ( nVertLevels nEdges Time ) 2 - h_kappa_q state - -
var persistent real    divergence ( nVertLevels nCells Time ) 2 o divergence state - -
var persistent real    vorticity ( nVertLevels nVertices Time ) 2 o vorticity state - -
var persistent real    Vor_edge ( nVertLevels nEdges Time ) 2 - Vor_edge state - -
var persistent real    h_edge ( nVertLevels nEdges Time ) 2 - h_edge state - -
var persistent real    h_vertex ( nVertLevels nVertices Time ) 2 - h_vertex state - -
var persistent real    ke ( nVertLevels nCells Time ) 2 o ke state - -
var persistent real    kev ( nVertLevels nVertices Time ) 2 o kev state - -
var persistent real    kevc ( nVertLevels nCells Time ) 2 o kevc state - -
var persistent real    ke_edge ( nVertLevels nEdges Time ) 2 - ke_edge state - -
var persistent real    Vor_vertex ( nVertLevels nVertices Time ) 2 - Vor_vertex state - -
var persistent real    Vor_cell ( nVertLevels nCells Time ) 2 o Vor_cell state - -
var persistent real    uReconstructX ( nVertLevels nCells Time ) 2 - uReconstructX state - -
var persistent real    uReconstructY ( nVertLevels nCells Time ) 2 - uReconstructY state - -
var persistent real    uReconstructZ ( nVertLevels nCells Time ) 2 - uReconstructZ state - -
var persistent real    uReconstructZonal ( nVertLevels nCells Time ) 2 o uReconstructZonal state - -
var persistent real    uReconstructMeridional ( nVertLevels nCells Time ) 2 o uReconstructMeridional state - -
var persistent real    uSrcReconstructX ( nVertLevels nCells Time ) 2 - uSrcReconstructX state - -
var persistent real    uSrcReconstructY ( nVertLevels nCells Time ) 2 - uSrcReconstructY state - -
var persistent real    uSrcReconstructZ ( nVertLevels nCells Time ) 2 - uSrcReconstructZ state - -
var persistent real    uSrcReconstructZonal ( nVertLevels nCells Time ) 2 o uSrcReconstructZonal state - -
var persistent real    uSrcReconstructMeridional ( nVertLevels nCells Time ) 2 o uSrcReconstructMeridional state - -
var persistent real    MontPot ( nVertLevels nCells Time ) 2 - MontPot state - -
var persistent real    pressure ( nVertLevels nCells Time ) 2 - pressure state - -
var persistent real    wTop ( nVertLevelsP1 nCells Time ) 2 - wTop state - -
var persistent real    rhoDisplaced ( nVertLevels nCells Time ) 2 - rhoDisplaced state - -
var persistent real    viscosity ( nVertLevels nEdges Time ) 2 o viscosity state - -

% Other diagnostic variables: neither read nor written to any files
var persistent real    vh ( nVertLevels nEdges Time ) 2 - vh state - -
var persistent real    circulation ( nVertLevels nVertices Time ) 2 - circulation state - -
var persistent real    gradVor_t ( nVertLevels nEdges Time ) 2 - gradVor_t state - -
var persistent real    gradVor_n ( nVertLevels nEdges Time ) 2 - gradVor_n state - -

% Globally reduced diagnostic variables: only written to output
var persistent real    areaCellGlobal ( Time ) 2 o areaCellGlobal state - -
var persistent real    areaEdgeGlobal ( Time ) 2 o areaEdgeGlobal state - -
var persistent real    areaTriangleGlobal ( Time ) 2 o areaTriangleGlobal state - -

var persistent real    volumeCellGlobal ( Time ) 2 o volumeCellGlobal state - -
var persistent real    volumeEdgeGlobal ( Time ) 2 o volumeEdgeGlobal state - -
var persistent real    CFLNumberGlobal ( Time ) 2 o CFLNumberGlobal state - -

% Diagnostics fields, only one time level required
var persistent real    RiTopOfCell ( nVertLevelsP1 nCells Time ) 1 - RiTopOfCell diagnostics - -
var persistent real    RiTopOfEdge ( nVertLevelsP1 nEdges Time ) 1 - RiTopOfEdge diagnostics - -
var persistent real    vertViscTopOfEdge ( nVertLevelsP1 nEdges Time ) 1 - vertViscTopOfEdge diagnostics - -
var persistent real    vertDiffTopOfCell ( nVertLevelsP1 nCells Time ) 1 - vertDiffTopOfCell diagnostics - -

var persistent real    nAccumulate ( Time ) 2 o nAccumulate state - -
var persistent real    acc_ssh ( nCells Time ) 2 o acc_ssh state - -
var persistent real    acc_sshVar ( nCells Time ) 2 o acc_sshVar state - -
var persistent real    acc_uReconstructZonal ( nVertLevels nCells Time ) 2 o acc_uReconstructZonal state - -
var persistent real    acc_uReconstructMeridional ( nVertLevels nCells Time ) 2 o acc_uReconstructMeridional state - -
var persistent real    acc_uReconstructZonalVar ( nVertLevels nCells Time ) 2 o acc_uReconstructZonalVar state - -
var persistent real    acc_uReconstructMeridionalVar ( nVertLevels nCells Time ) 2 o acc_uReconstructMeridionalVar state - -
var persistent real    acc_u ( nVertLevels nEdges Time ) 2 o acc_u state - -
var persistent real    acc_uVar ( nVertLevels nEdges Time ) 2 o acc_uVar state - -

% Sign fields, for openmp and bit reproducibility without branching statements.
var persistent integer edgeSignOnCell ( maxEdges nCells ) 0 - edgeSignOnCell mesh - -
var persistent integer edgeSignOnVertex ( maxEdges nVertices ) 0 - edgeSignOnVertex mesh - -
var persistent integer kiteIndexOnCell ( maxEdges nCells ) 0 - kiteIndexOnCell mesh - -
